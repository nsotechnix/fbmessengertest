{"ast":null,"code":"import React, { useEffect } from 'react'; // Customer chat sdk: https://developers.facebook.com/docs/messenger-platform/discovery/customer-chat-plugin/sdk/\n// flag to identify wether or not messenger chat is mounted\n\nlet isMounted = false; // added to be able to access debug mode outside component\n\nlet globalDebugModeFlag = false;\nconst MessengerChat = React.forwardRef((_ref, ref) => {\n  let {\n    pageId,\n    language = \"en_US\",\n    themeColor,\n    height,\n    autoExpand = true,\n    loggedInGreeting,\n    loggedOutGreeting,\n    onMessengerMounted,\n    onMessengerLoad,\n    onMessengerShow,\n    onMessengerHide,\n    onMessengerDialogShow,\n    onMessengerDialogHide,\n    debugMode = false,\n    version = \"v11.0\"\n  } = _ref;\n\n  const initExpand = () => {\n    var _a;\n\n    if (debugMode) {\n      console.log(\"[react-messenger-chat-plugin] expanding on init\");\n    }\n\n    try {\n      const localStorageObject = localStorage.getItem(\"__fb_chat_plugin\");\n      const cachedChatState = localStorageObject ? JSON.parse(localStorageObject) : null; //https://developer.mozilla.org/en-US/docs/Web/API/PerformanceNavigationTiming/type\n\n      const samePageNavigation = //@ts-ignore\n      ((_a = performance === null || performance === void 0 ? void 0 : performance.getEntriesByType(\"navigation\")[0]) === null || _a === void 0 ? void 0 : _a.type) !== \"navigate\";\n\n      if (cachedChatState && (cachedChatState === null || cachedChatState === void 0 ? void 0 : cachedChatState.visibility) === \"hidden\" && !samePageNavigation) {\n        FB.CustomerChat.show();\n      }\n    } catch (err) {\n      console.warn(\"Probblem when autoexpanding messenger chatbox occured. Please file an issue on github.\");\n      throw new Error(err);\n    }\n  };\n\n  const initMessenger = () => {\n    if (debugMode) {\n      console.log(\"[react-messenger-chat-plugin] initializing messenger plugin\");\n    }\n\n    try {\n      const chatbox = document.getElementById(\"fb-customer-chat\");\n      chatbox.setAttribute(\"page_id\", pageId);\n      chatbox.setAttribute(\"attribution\", \"biz_inbox\");\n\n      if (themeColor) {\n        chatbox.setAttribute(\"theme_color\", themeColor);\n      }\n\n      if (loggedInGreeting) {\n        chatbox.setAttribute(\"logged_in_greeting\", loggedInGreeting);\n      }\n\n      if (loggedOutGreeting) {\n        chatbox.setAttribute(\"logged_out_greeting\", loggedOutGreeting);\n      }\n\n      if (autoExpand) {\n        chatbox.setAttribute(\"greeting_dialog_display\", \"show\");\n        chatbox.setAttribute(\"greeting_dialog_delay\", \"0\");\n      } else {\n        chatbox.setAttribute(\"greeting_dialog_display\", \"hide\");\n      }\n\n      if (height != undefined) {\n        setMessengerHeight(height);\n      }\n\n      window.fbAsyncInit = function () {\n        FB.init({\n          xfbml: true,\n          version: version\n        });\n        FB.Event.subscribe(\"customerchat.load\", () => {\n          // we check if not undefined, since 0 should still be a valid number\n          if (onMessengerLoad) onMessengerLoad();\n        });\n        FB.Event.subscribe(\"xfbml.render\", () => {\n          //this is necessary to manually open chatbox on init when state (especially visibility=hidden) is cached in localStorage.\n          if (autoExpand) {\n            setTimeout(initExpand, 3000);\n          }\n\n          if (onMessengerMounted) {\n            onMessengerMounted();\n          }\n\n          isMounted = true;\n        });\n        FB.Event.subscribe(\"customerchat.show\", () => {\n          if (onMessengerShow) onMessengerShow();\n        });\n        FB.Event.subscribe(\"customerchat.hide\", () => {\n          if (onMessengerHide) onMessengerHide();\n        });\n        FB.Event.subscribe(\"customerchat.dialogShow\", () => {\n          if (onMessengerDialogShow) onMessengerDialogShow();\n        });\n        FB.Event.subscribe(\"customerchat.dialogHide\", () => {\n          if (onMessengerDialogHide) onMessengerDialogHide();\n        });\n      };\n\n      (function (d, s, id) {\n        var _a;\n\n        let js,\n            // eslint-disable-next-line prefer-const\n        fjs = d.getElementsByTagName(s)[0];\n        if (d.getElementById(id)) return; // eslint-disable-next-line prefer-const\n\n        js = d.createElement(s);\n        js.id = id;\n        js.src = `https://connect.facebook.net/${language}/sdk/xfbml.customerchat.js`;\n        (_a = fjs === null || fjs === void 0 ? void 0 : fjs.parentNode) === null || _a === void 0 ? void 0 : _a.insertBefore(js, fjs);\n      })(document, \"script\", \"facebook-jssdk\");\n    } catch (err) {\n      throw err;\n    }\n  };\n\n  useEffect(() => {\n    try {\n      globalDebugModeFlag = debugMode;\n      initMessenger();\n    } catch (err) {\n      console.log(err);\n    }\n  });\n  return React.createElement(\"div\", {\n    ref: ref\n  }, React.createElement(\"div\", {\n    id: \"fb-root\"\n  }), React.createElement(\"div\", {\n    id: \"fb-customer-chat\",\n    className: \"fb-customerchat\"\n  }));\n}); //NOTE: THIS IS A VERY HACKY WAY OF MODIFYING ELEMENTS STYLE.\n\nconst setMessengerHeight = height => {\n  if (globalDebugModeFlag) {\n    console.log(`[react-messenger-chat-plugin] setting messenger height: ${height}`);\n  }\n\n  const css = `\n  .fb-customerchat {\n    display: none !important;\n    visibility: hidden !important;\n  }\n\n  [data-testid=\"bubble_iframe\"] {\n    bottom: ${height}px !important;\n  }\n\n  [data-testid='dialog_iframe'] {\n    bottom: ${height + 56}px !important;\n  }\n  `;\n  const style = document.createElement(\"style\");\n  document.head.appendChild(style);\n  style.type = \"text/css\";\n  style.appendChild(document.createTextNode(css));\n};\n\nconst showMessenger = shouldShowDialog => {\n  if (globalDebugModeFlag) {\n    console.log(`[react-messenger-chat-plugin] showing messenger with argument \"shouldShowDialog\": ${shouldShowDialog}`);\n  }\n\n  try {\n    if (isMounted && (FB === null || FB === void 0 ? void 0 : FB.CustomerChat)) {\n      FB.CustomerChat.show(shouldShowDialog);\n    } else if (!isMounted) {\n      console.warn(\"Messenger could not expand messenger due to the messenger chat not beeing mounted yet.\");\n    }\n  } catch (err) {\n    throw new Error(err);\n  }\n};\n\nconst hideMessenger = () => {\n  if (globalDebugModeFlag) {\n    console.log(`[react-messenger-chat-plugin] hiding messenger with argument`);\n  }\n\n  try {\n    if (isMounted && (FB === null || FB === void 0 ? void 0 : FB.CustomerChat)) {\n      FB.CustomerChat.hide();\n    } else if (!isMounted) {\n      console.warn(\"Messenger could not hide messenger due to the messenger chat not beeing mounted yet.\");\n    }\n  } catch (err) {\n    throw new Error(err);\n  }\n};\n\nconst showDialog = () => {\n  if (globalDebugModeFlag) {\n    console.log(`[react-messenger-chat-plugin] showing dialog`);\n  }\n\n  try {\n    if (isMounted && (FB === null || FB === void 0 ? void 0 : FB.CustomerChat)) {\n      FB.CustomerChat.showDialog();\n    } else if (!isMounted) {\n      console.warn(\"Messenger could not show dialog due to the messenger chat not beeing mounted yet.\");\n    }\n  } catch (err) {\n    throw new Error(err);\n  }\n};\n\nconst hideDialog = () => {\n  if (globalDebugModeFlag) {\n    console.log(`[react-messenger-chat-plugin] hiding dialog`);\n  }\n\n  try {\n    if (isMounted && (FB === null || FB === void 0 ? void 0 : FB.CustomerChat)) {\n      FB.CustomerChat.hideDialog();\n    } else if (!isMounted) {\n      console.warn(\"Messenger could not hide dialog due to the messenger chat not beeing mounted yet.\");\n    }\n  } catch (err) {\n    throw new Error(err);\n  }\n};\n\nexport { MessengerChat, hideDialog, hideMessenger, setMessengerHeight, showDialog, showMessenger };","map":{"version":3,"sources":["/home/otechnix/Documents/fbmessengertest/node_modules/react-messenger-chat-plugin/dist/index.js"],"names":["React","useEffect","isMounted","globalDebugModeFlag","MessengerChat","forwardRef","ref","pageId","language","themeColor","height","autoExpand","loggedInGreeting","loggedOutGreeting","onMessengerMounted","onMessengerLoad","onMessengerShow","onMessengerHide","onMessengerDialogShow","onMessengerDialogHide","debugMode","version","initExpand","_a","console","log","localStorageObject","localStorage","getItem","cachedChatState","JSON","parse","samePageNavigation","performance","getEntriesByType","type","visibility","FB","CustomerChat","show","err","warn","Error","initMessenger","chatbox","document","getElementById","setAttribute","undefined","setMessengerHeight","window","fbAsyncInit","init","xfbml","Event","subscribe","setTimeout","d","s","id","js","fjs","getElementsByTagName","createElement","src","parentNode","insertBefore","className","css","style","head","appendChild","createTextNode","showMessenger","shouldShowDialog","hideMessenger","hide","showDialog","hideDialog"],"mappings":"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","sourcesContent":["import React, { useEffect } from 'react';\n\n// Customer chat sdk: https://developers.facebook.com/docs/messenger-platform/discovery/customer-chat-plugin/sdk/\r\n// flag to identify wether or not messenger chat is mounted\r\nlet isMounted = false;\r\n// added to be able to access debug mode outside component\r\nlet globalDebugModeFlag = false;\r\nconst MessengerChat = React.forwardRef(({ pageId, language = \"en_US\", themeColor, height, autoExpand = true, loggedInGreeting, loggedOutGreeting, onMessengerMounted, onMessengerLoad, onMessengerShow, onMessengerHide, onMessengerDialogShow, onMessengerDialogHide, debugMode = false, version = \"v11.0\", }, ref) => {\r\n    const initExpand = () => {\r\n        var _a;\r\n        if (debugMode) {\r\n            console.log(\"[react-messenger-chat-plugin] expanding on init\");\r\n        }\r\n        try {\r\n            const localStorageObject = localStorage.getItem(\"__fb_chat_plugin\");\r\n            const cachedChatState = localStorageObject\r\n                ? JSON.parse(localStorageObject)\r\n                : null;\r\n            //https://developer.mozilla.org/en-US/docs/Web/API/PerformanceNavigationTiming/type\r\n            const samePageNavigation = //@ts-ignore\r\n             ((_a = performance === null || performance === void 0 ? void 0 : performance.getEntriesByType(\"navigation\")[0]) === null || _a === void 0 ? void 0 : _a.type) !== \"navigate\";\r\n            if (cachedChatState &&\r\n                (cachedChatState === null || cachedChatState === void 0 ? void 0 : cachedChatState.visibility) === \"hidden\" &&\r\n                !samePageNavigation) {\r\n                FB.CustomerChat.show();\r\n            }\r\n        }\r\n        catch (err) {\r\n            console.warn(\"Probblem when autoexpanding messenger chatbox occured. Please file an issue on github.\");\r\n            throw new Error(err);\r\n        }\r\n    };\r\n    const initMessenger = () => {\r\n        if (debugMode) {\r\n            console.log(\"[react-messenger-chat-plugin] initializing messenger plugin\");\r\n        }\r\n        try {\r\n            const chatbox = document.getElementById(\"fb-customer-chat\");\r\n            chatbox.setAttribute(\"page_id\", pageId);\r\n            chatbox.setAttribute(\"attribution\", \"biz_inbox\");\r\n            if (themeColor) {\r\n                chatbox.setAttribute(\"theme_color\", themeColor);\r\n            }\r\n            if (loggedInGreeting) {\r\n                chatbox.setAttribute(\"logged_in_greeting\", loggedInGreeting);\r\n            }\r\n            if (loggedOutGreeting) {\r\n                chatbox.setAttribute(\"logged_out_greeting\", loggedOutGreeting);\r\n            }\r\n            if (autoExpand) {\r\n                chatbox.setAttribute(\"greeting_dialog_display\", \"show\");\r\n                chatbox.setAttribute(\"greeting_dialog_delay\", \"0\");\r\n            }\r\n            else {\r\n                chatbox.setAttribute(\"greeting_dialog_display\", \"hide\");\r\n            }\r\n            if (height != undefined) {\r\n                setMessengerHeight(height);\r\n            }\r\n            window.fbAsyncInit = function () {\r\n                FB.init({\r\n                    xfbml: true,\r\n                    version: version,\r\n                });\r\n                FB.Event.subscribe(\"customerchat.load\", () => {\r\n                    // we check if not undefined, since 0 should still be a valid number\r\n                    if (onMessengerLoad)\r\n                        onMessengerLoad();\r\n                });\r\n                FB.Event.subscribe(\"xfbml.render\", () => {\r\n                    //this is necessary to manually open chatbox on init when state (especially visibility=hidden) is cached in localStorage.\r\n                    if (autoExpand) {\r\n                        setTimeout(initExpand, 3000);\r\n                    }\r\n                    if (onMessengerMounted) {\r\n                        onMessengerMounted();\r\n                    }\r\n                    isMounted = true;\r\n                });\r\n                FB.Event.subscribe(\"customerchat.show\", () => {\r\n                    if (onMessengerShow)\r\n                        onMessengerShow();\r\n                });\r\n                FB.Event.subscribe(\"customerchat.hide\", () => {\r\n                    if (onMessengerHide)\r\n                        onMessengerHide();\r\n                });\r\n                FB.Event.subscribe(\"customerchat.dialogShow\", () => {\r\n                    if (onMessengerDialogShow)\r\n                        onMessengerDialogShow();\r\n                });\r\n                FB.Event.subscribe(\"customerchat.dialogHide\", () => {\r\n                    if (onMessengerDialogHide)\r\n                        onMessengerDialogHide();\r\n                });\r\n            };\r\n            (function (d, s, id) {\r\n                var _a;\r\n                let js, \r\n                // eslint-disable-next-line prefer-const\r\n                fjs = d.getElementsByTagName(s)[0];\r\n                if (d.getElementById(id))\r\n                    return;\r\n                // eslint-disable-next-line prefer-const\r\n                js = d.createElement(s);\r\n                js.id = id;\r\n                js.src = `https://connect.facebook.net/${language}/sdk/xfbml.customerchat.js`;\r\n                (_a = fjs === null || fjs === void 0 ? void 0 : fjs.parentNode) === null || _a === void 0 ? void 0 : _a.insertBefore(js, fjs);\r\n            })(document, \"script\", \"facebook-jssdk\");\r\n        }\r\n        catch (err) {\r\n            throw err;\r\n        }\r\n    };\r\n    useEffect(() => {\r\n        try {\r\n            globalDebugModeFlag = debugMode;\r\n            initMessenger();\r\n        }\r\n        catch (err) {\r\n            console.log(err);\r\n        }\r\n    });\r\n    return (React.createElement(\"div\", { ref: ref },\r\n        React.createElement(\"div\", { id: \"fb-root\" }),\r\n        React.createElement(\"div\", { id: \"fb-customer-chat\", className: \"fb-customerchat\" })));\r\n});\r\n//NOTE: THIS IS A VERY HACKY WAY OF MODIFYING ELEMENTS STYLE.\r\nconst setMessengerHeight = (height) => {\r\n    if (globalDebugModeFlag) {\r\n        console.log(`[react-messenger-chat-plugin] setting messenger height: ${height}`);\r\n    }\r\n    const css = `\r\n  .fb-customerchat {\r\n    display: none !important;\r\n    visibility: hidden !important;\r\n  }\r\n\r\n  [data-testid=\"bubble_iframe\"] {\r\n    bottom: ${height}px !important;\r\n  }\r\n\r\n  [data-testid='dialog_iframe'] {\r\n    bottom: ${height + 56}px !important;\r\n  }\r\n  `;\r\n    const style = document.createElement(\"style\");\r\n    document.head.appendChild(style);\r\n    style.type = \"text/css\";\r\n    style.appendChild(document.createTextNode(css));\r\n};\r\nconst showMessenger = (shouldShowDialog) => {\r\n    if (globalDebugModeFlag) {\r\n        console.log(`[react-messenger-chat-plugin] showing messenger with argument \"shouldShowDialog\": ${shouldShowDialog}`);\r\n    }\r\n    try {\r\n        if (isMounted && (FB === null || FB === void 0 ? void 0 : FB.CustomerChat)) {\r\n            FB.CustomerChat.show(shouldShowDialog);\r\n        }\r\n        else if (!isMounted) {\r\n            console.warn(\"Messenger could not expand messenger due to the messenger chat not beeing mounted yet.\");\r\n        }\r\n    }\r\n    catch (err) {\r\n        throw new Error(err);\r\n    }\r\n};\r\nconst hideMessenger = () => {\r\n    if (globalDebugModeFlag) {\r\n        console.log(`[react-messenger-chat-plugin] hiding messenger with argument`);\r\n    }\r\n    try {\r\n        if (isMounted && (FB === null || FB === void 0 ? void 0 : FB.CustomerChat)) {\r\n            FB.CustomerChat.hide();\r\n        }\r\n        else if (!isMounted) {\r\n            console.warn(\"Messenger could not hide messenger due to the messenger chat not beeing mounted yet.\");\r\n        }\r\n    }\r\n    catch (err) {\r\n        throw new Error(err);\r\n    }\r\n};\r\nconst showDialog = () => {\r\n    if (globalDebugModeFlag) {\r\n        console.log(`[react-messenger-chat-plugin] showing dialog`);\r\n    }\r\n    try {\r\n        if (isMounted && (FB === null || FB === void 0 ? void 0 : FB.CustomerChat)) {\r\n            FB.CustomerChat.showDialog();\r\n        }\r\n        else if (!isMounted) {\r\n            console.warn(\"Messenger could not show dialog due to the messenger chat not beeing mounted yet.\");\r\n        }\r\n    }\r\n    catch (err) {\r\n        throw new Error(err);\r\n    }\r\n};\r\nconst hideDialog = () => {\r\n    if (globalDebugModeFlag) {\r\n        console.log(`[react-messenger-chat-plugin] hiding dialog`);\r\n    }\r\n    try {\r\n        if (isMounted && (FB === null || FB === void 0 ? void 0 : FB.CustomerChat)) {\r\n            FB.CustomerChat.hideDialog();\r\n        }\r\n        else if (!isMounted) {\r\n            console.warn(\"Messenger could not hide dialog due to the messenger chat not beeing mounted yet.\");\r\n        }\r\n    }\r\n    catch (err) {\r\n        throw new Error(err);\r\n    }\r\n};\n\nexport { MessengerChat, hideDialog, hideMessenger, setMessengerHeight, showDialog, showMessenger };\n"]},"metadata":{},"sourceType":"module"}